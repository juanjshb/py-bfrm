
-----------------------------------------
-- SECCIÓN 2: DATOS DE PRUEBA
-----------------------------------------
-- Insertar Paises
INSERT INTO countries (iso2, iso3, numeric_code, name, region, subregion) VALUES
('AF','AFG','004','Afghanistan','Asia','Southern Asia'),
('AX','ALA','248','Åland Islands','Europe','Northern Europe'),
('AL','ALB','008','Albania','Europe','Southern Europe'),
('DZ','DZA','012','Algeria','Africa','Northern Africa'),
('AS','ASM','016','American Samoa','Oceania','Polynesia'),
('AD','AND','020','Andorra','Europe','Southern Europe'),
('AO','AGO','024','Angola','Africa','Sub-Saharan Africa'),
('AI','AIA','660','Anguilla','Americas','Caribbean'),
('AQ','ATA','010','Antarctica','Antarctica','Antarctica'),
('AG','ATG','028','Antigua and Barbuda','Americas','Caribbean'),
('AR','ARG','032','Argentina','Americas','South America'),
('AM','ARM','051','Armenia','Asia','Western Asia'),
('AW','ABW','533','Aruba','Americas','Caribbean'),
('AU','AUS','036','Australia','Oceania','Australia and New Zealand'),
('AT','AUT','040','Austria','Europe','Western Europe'),
('AZ','AZE','031','Azerbaijan','Asia','Western Asia'),
('BS','BHS','044','Bahamas','Americas','Caribbean'),
('BH','BHR','048','Bahrain','Asia','Western Asia'),
('BD','BGD','050','Bangladesh','Asia','Southern Asia'),
('BB','BRB','052','Barbados','Americas','Caribbean'),
('BY','BLR','112','Belarus','Europe','Eastern Europe'),
('BE','BEL','056','Belgium','Europe','Western Europe'),
('BZ','BLZ','084','Belize','Americas','Central America'),
('BJ','BEN','204','Benin','Africa','Sub-Saharan Africa'),
('BM','BMU','060','Bermuda','Americas','Northern America'),
('BT','BTN','064','Bhutan','Asia','Southern Asia'),
('BO','BOL','068','Bolivia','Americas','South America'),
('BQ','BES','535','Bonaire, Sint Eustatius and Saba','Americas','Caribbean'),
('BA','BIH','070','Bosnia and Herzegovina','Europe','Southern Europe'),
('BW','BWA','072','Botswana','Africa','Sub-Saharan Africa'),
('BV','BVT','074','Bouvet Island','Antarctica','Antarctica'),
('BR','BRA','076','Brazil','Americas','South America'),
('IO','IOT','086','British Indian Ocean Territory','Africa','Sub-Saharan Africa'),
('BN','BRN','096','Brunei Darussalam','Asia','South-Eastern Asia'),
('BG','BGR','100','Bulgaria','Europe','Eastern Europe'),
('BF','BFA','854','Burkina Faso','Africa','Sub-Saharan Africa'),
('BI','BDI','108','Burundi','Africa','Sub-Saharan Africa'),
('CV','CPV','132','Cabo Verde','Africa','Sub-Saharan Africa'),
('KH','KHM','116','Cambodia','Asia','South-Eastern Asia'),
('CM','CMR','120','Cameroon','Africa','Sub-Saharan Africa'),
('CA','CAN','124','Canada','Americas','Northern America'),
('KY','CYM','136','Cayman Islands','Americas','Caribbean'),
('CF','CAF','140','Central African Republic','Africa','Sub-Saharan Africa'),
('TD','TCD','148','Chad','Africa','Sub-Saharan Africa'),
('CL','CHL','152','Chile','Americas','South America'),
('CN','CHN','156','China','Asia','Eastern Asia'),
('CX','CXR','162','Christmas Island','Oceania','Australia and New Zealand'),
('CC','CCK','166','Cocos (Keeling) Islands','Oceania','Australia and New Zealand'),
('CO','COL','170','Colombia','Americas','South America'),
('KM','COM','174','Comoros','Africa','Sub-Saharan Africa'),
('CD','COD','180','Congo (DRC)','Africa','Sub-Saharan Africa'),
('CG','COG','178','Congo','Africa','Sub-Saharan Africa'),
('CK','COK','184','Cook Islands','Oceania','Polynesia'),
('CR','CRI','188','Costa Rica','Americas','Central America'),
('CI','CIV','384','Côte d Ivoire','Africa','Sub-Saharan Africa'),
('HR','HRV','191','Croatia','Europe','Southern Europe'),
('CU','CUB','192','Cuba','Americas','Caribbean'),
('CW','CUW','531','Curaçao','Americas','Caribbean'),
('CY','CYP','196','Cyprus','Asia','Western Asia'),
('CZ','CZE','203','Czechia','Europe','Eastern Europe'),
('DK','DNK','208','Denmark','Europe','Northern Europe'),
('DJ','DJI','262','Djibouti','Africa','Sub-Saharan Africa'),
('DM','DMA','212','Dominica','Americas','Caribbean'),
('DO','DOM','214','Dominican Republic','Americas','Caribbean'),
('EC','ECU','218','Ecuador','Americas','South America'),
('EG','EGY','818','Egypt','Africa','Northern Africa'),
('SV','SLV','222','El Salvador','Americas','Central America'),
('GQ','GNQ','226','Equatorial Guinea','Africa','Sub-Saharan Africa'),
('ER','ERI','232','Eritrea','Africa','Sub-Saharan Africa'),
('EE','EST','233','Estonia','Europe','Northern Europe'),
('SZ','SWZ','748','Eswatini','Africa','Sub-Saharan Africa'),
('ET','ETH','231','Ethiopia','Africa','Sub-Saharan Africa'),
('FK','FLK','238','Falkland Islands','Americas','South America'),
('FO','FRO','234','Faroe Islands','Europe','Northern Europe'),
('FJ','FJI','242','Fiji','Oceania','Melanesia'),
('FI','FIN','246','Finland','Europe','Northern Europe'),
('FR','FRA','250','France','Europe','Western Europe'),
('GF','GUF','254','French Guiana','Americas','South America'),
('PF','PYF','258','French Polynesia','Oceania','Polynesia'),
('TF','ATF','260','French Southern Territories','Antarctica','Antarctica'),
('GA','GAB','266','Gabon','Africa','Sub-Saharan Africa'),
('GM','GMB','270','Gambia','Africa','Sub-Saharan Africa'),
('GE','GEO','268','Georgia','Asia','Western Asia'),
('DE','DEU','276','Germany','Europe','Western Europe'),
('GH','GHA','288','Ghana','Africa','Sub-Saharan Africa'),
('GI','GIB','292','Gibraltar','Europe','Southern Europe'),
('GR','GRC','300','Greece','Europe','Southern Europe'),
('GL','GRL','304','Greenland','Americas','Northern America'),
('GD','GRD','308','Grenada','Americas','Caribbean'),
('GP','GLP','312','Guadeloupe','Americas','Caribbean'),
('GU','GUM','316','Guam','Oceania','Micronesia'),
('GT','GTM','320','Guatemala','Americas','Central America'),
('GG','GGY','831','Guernsey','Europe','Northern Europe'),
('GN','GIN','324','Guinea','Africa','Sub-Saharan Africa'),
('GW','GNB','624','Guinea-Bissau','Africa','Sub-Saharan Africa'),
('GY','GUY','328','Guyana','Americas','South America'),
('HT','HTI','332','Haiti','Americas','Caribbean'),
('HM','HMD','334','Heard Island and McDonald Islands','Antarctica','Antarctica'),
('VA','VAT','336','Holy See','Europe','Southern Europe'),
('HN','HND','340','Honduras','Americas','Central America'),
('HK','HKG','344','Hong Kong','Asia','Eastern Asia'),
('HU','HUN','348','Hungary','Europe','Eastern Europe'),
('IS','ISL','352','Iceland','Europe','Northern Europe'),
('IN','IND','356','India','Asia','Southern Asia'),
('ID','IDN','360','Indonesia','Asia','South-Eastern Asia'),
('IR','IRN','364','Iran','Asia','Southern Asia'),
('IQ','IRQ','368','Iraq','Asia','Western Asia'),
('IE','IRL','372','Ireland','Europe','Northern Europe'),
('IM','IMN','833','Isle of Man','Europe','Northern Europe'),
('IL','ISR','376','Israel','Asia','Western Asia'),
('IT','ITA','380','Italy','Europe','Southern Europe'),
('JM','JAM','388','Jamaica','Americas','Caribbean'),
('JP','JPN','392','Japan','Asia','Eastern Asia'),
('JE','JEY','832','Jersey','Europe','Northern Europe'),
('JO','JOR','400','Jordan','Asia','Western Asia'),
('KZ','KAZ','398','Kazakhstan','Asia','Central Asia'),
('KE','KEN','404','Kenya','Africa','Sub-Saharan Africa'),
('KI','KIR','296','Kiribati','Oceania','Micronesia'),
('KP','PRK','408','Korea (North)','Asia','Eastern Asia'),
('KR','KOR','410','Korea (South)','Asia','Eastern Asia'),
('KW','KWT','414','Kuwait','Asia','Western Asia'),
('KG','KGZ','417','Kyrgyzstan','Asia','Central Asia'),
('LA','LAO','418','Lao People''s Democratic Republic','Asia','South-Eastern Asia'),
('LV','LVA','428','Latvia','Europe','Northern Europe'),
('LB','LBN','422','Lebanon','Asia','Western Asia'),
('LS','LSO','426','Lesotho','Africa','Sub-Saharan Africa'),
('LR','LBR','430','Liberia','Africa','Sub-Saharan Africa'),
('LY','LBY','434','Libya','Africa','Northern Africa'),
('LI','LIE','438','Liechtenstein','Europe','Western Europe'),
('LT','LTU','440','Lithuania','Europe','Northern Europe'),
('LU','LUX','442','Luxembourg','Europe','Western Europe'),
('MO','MAC','446','Macao','Asia','Eastern Asia'),
('MG','MDG','450','Madagascar','Africa','Sub-Saharan Africa'),
('MW','MWI','454','Malawi','Africa','Sub-Saharan Africa'),
('MY','MYS','458','Malaysia','Asia','South-Eastern Asia'),
('MV','MDV','462','Maldives','Asia','Southern Asia'),
('ML','MLI','466','Mali','Africa','Sub-Saharan Africa'),
('MT','MLT','470','Malta','Europe','Southern Europe'),
('MH','MHL','584','Marshall Islands','Oceania','Micronesia'),
('MQ','MTQ','474','Martinique','Americas','Caribbean'),
('MR','MRT','478','Mauritania','Africa','Sub-Saharan Africa'),
('MU','MUS','480','Mauritius','Africa','Sub-Saharan Africa'),
('YT','MYT','175','Mayotte','Africa','Sub-Saharan Africa'),
('MX','MEX','484','Mexico','Americas','Central America'),
('FM','FSM','583','Micronesia (Federated States of)','Oceania','Micronesia'),
('MD','MDA','498','Moldova','Europe','Eastern Europe'),
('MC','MCO','492','Monaco','Europe','Western Europe'),
('MN','MNG','496','Mongolia','Asia','Eastern Asia'),
('ME','MNE','499','Montenegro','Europe','Southern Europe'),
('MS','MSR','500','Montserrat','Americas','Caribbean'),
('MA','MAR','504','Morocco','Africa','Northern Africa'),
('MZ','MOZ','508','Mozambique','Africa','Sub-Saharan Africa'),
('MM','MMR','104','Myanmar','Asia','South-Eastern Asia'),
('NA','NAM','516','Namibia','Africa','Sub-Saharan Africa'),
('NR','NRU','520','Nauru','Oceania','Micronesia'),
('NP','NPL','524','Nepal','Asia','Southern Asia'),
('NL','NLD','528','Netherlands','Europe','Western Europe'),
('NC','NCL','540','New Caledonia','Oceania','Melanesia'),
('NZ','NZL','554','New Zealand','Oceania','Australia and New Zealand'),
('NI','NIC','558','Nicaragua','Americas','Central America'),
('NE','NER','562','Niger','Africa','Sub-Saharan Africa'),
('NG','NGA','566','Nigeria','Africa','Sub-Saharan Africa'),
('NU','NIU','570','Niue','Oceania','Polynesia'),
('NF','NFK','574','Norfolk Island','Oceania','Australia and New Zealand'),
('MP','MNP','580','Northern Mariana Islands','Oceania','Micronesia'),
('NO','NOR','578','Norway','Europe','Northern Europe'),
('OM','OMN','512','Oman','Asia','Western Asia'),
('PK','PAK','586','Pakistan','Asia','Southern Asia'),
('PW','PLW','585','Palau','Oceania','Micronesia'),
('PS','PSE','275','Palestine, State of','Asia','Western Asia'),
('PA','PAN','591','Panama','Americas','Central America'),
('PG','PNG','598','Papua New Guinea','Oceania','Melanesia'),
('PY','PRY','600','Paraguay','Americas','South America'),
('PE','PER','604','Peru','Americas','South America'),
('PH','PHL','608','Philippines','Asia','South-Eastern Asia'),
('PN','PCN','612','Pitcairn','Oceania','Polynesia'),
('PL','POL','616','Poland','Europe','Eastern Europe'),
('PT','PRT','620','Portugal','Europe','Southern Europe'),
('PR','PRI','630','Puerto Rico','Americas','Caribbean'),
('QA','QAT','634','Qatar','Asia','Western Asia'),
('MK','MKD','807','North Macedonia','Europe','Southern Europe'),
('RO','ROU','642','Romania','Europe','Eastern Europe'),
('RU','RUS','643','Russian Federation','Europe','Eastern Europe'),
('RW','RWA','646','Rwanda','Africa','Sub-Saharan Africa'),
('RE','REU','638','Réunion','Africa','Sub-Saharan Africa'),
('BL','BLM','652','Saint Barthélemy','Americas','Caribbean'),
('SH','SHN','654','Saint Helena','Africa','Sub-Saharan Africa'),
('KN','KNA','659','Saint Kitts and Nevis','Americas','Caribbean'),
('LC','LCA','662','Saint Lucia','Americas','Caribbean'),
('MF','MAF','663','Saint Martin (French part)','Americas','Caribbean'),
('PM','SPM','666','Saint Pierre and Miquelon','Americas','Northern America'),
('VC','VCT','670','Saint Vincent and the Grenadines','Americas','Caribbean'),
('WS','WSM','882','Samoa','Oceania','Polynesia'),
('SM','SMR','674','San Marino','Europe','Southern Europe'),
('ST','STP','678','Sao Tome and Principe','Africa','Sub-Saharan Africa'),
('SA','SAU','682','Saudi Arabia','Asia','Western Asia'),
('SN','SEN','686','Senegal','Africa','Sub-Saharan Africa'),
('RS','SRB','688','Serbia','Europe','Southern Europe'),
('SC','SYC','690','Seychelles','Africa','Sub-Saharan Africa'),
('SL','SLE','694','Sierra Leone','Africa','Sub-Saharan Africa'),
('SG','SGP','702','Singapore','Asia','South-Eastern Asia'),
('SX','SXM','534','Sint Maarten (Dutch part)','Americas','Caribbean'),
('SK','SVK','703','Slovakia','Europe','Eastern Europe'),
('SI','SVN','705','Slovenia','Europe','Southern Europe'),
('SB','SLB','090','Solomon Islands','Oceania','Melanesia'),
('SO','SOM','706','Somalia','Africa','Sub-Saharan Africa'),
('ZA','ZAF','710','South Africa','Africa','Sub-Saharan Africa'),
('GS','SGS','239','South Georgia and the South Sandwich Islands','Antarctica','Antarctica'),
('SS','SSD','728','South Sudan','Africa','Sub-Saharan Africa'),
('ES','ESP','724','Spain','Europe','Southern Europe'),
('LK','LKA','144','Sri Lanka','Asia','Southern Asia'),
('SD','SDN','729','Sudan','Africa','Northern Africa'),
('SR','SUR','740','Suriname','Americas','South America'),
('SJ','SJM','744','Svalbard and Jan Mayen','Europe','Northern Europe'),
('SE','SWE','752','Sweden','Europe','Northern Europe'),
('CH','CHE','756','Switzerland','Europe','Western Europe'),
('SY','SYR','760','Syrian Arab Republic','Asia','Western Asia'),
('TW','TWN','158','Taiwan','Asia','Eastern Asia'),
('TJ','TJK','762','Tajikistan','Asia','Central Asia'),
('TZ','TZA','834','Tanzania','Africa','Sub-Saharan Africa'),
('TH','THA','764','Thailand','Asia','South-Eastern Asia'),
('TL','TLS','626','Timor-Leste','Asia','South-Eastern Asia'),
('TG','TGO','768','Togo','Africa','Sub-Saharan Africa'),
('TK','TKL','772','Tokelau','Oceania','Polynesia'),
('TO','TON','776','Tonga','Oceania','Polynesia'),
('TT','TTO','780','Trinidad and Tobago','Americas','Caribbean'),
('TN','TUN','788','Tunisia','Africa','Northern Africa'),
('TR','TUR','792','Turkey','Asia','Western Asia'),
('TM','TKM','795','Turkmenistan','Asia','Central Asia'),
('TC','TCA','796','Turks and Caicos Islands','Americas','Caribbean'),
('TV','TUV','798','Tuvalu','Oceania','Polynesia'),
('UG','UGA','800','Uganda','Africa','Sub-Saharan Africa'),
('UA','UKR','804','Ukraine','Europe','Eastern Europe'),
('AE','ARE','784','United Arab Emirates','Asia','Western Asia'),
('GB','GBR','826','United Kingdom','Europe','Northern Europe'),
('UM','UMI','581','United States Minor Outlying Islands','Oceania','Micronesia'),
('US','USA','840','United States of America','Americas','Northern America'),
('UY','URY','858','Uruguay','Americas','South America'),
('UZ','UZB','860','Uzbekistan','Asia','Central Asia'),
('VU','VUT','548','Vanuatu','Oceania','Melanesia'),
('VE','VEN','862','Venezuela','Americas','South America'),
('VN','VNM','704','Viet Nam','Asia','South-Eastern Asia'),
('VG','VGB','092','Virgin Islands (British)','Americas','Caribbean'),
('VI','VIR','850','Virgin Islands (U.S.)','Americas','Caribbean'),
('WF','WLF','876','Wallis and Futuna','Oceania','Polynesia'),
('EH','ESH','732','Western Sahara','Africa','Northern Africa'),
('YE','YEM','887','Yemen','Asia','Western Asia'),
('ZM','ZMB','894','Zambia','Africa','Sub-Saharan Africa'),
('ZW','ZWE','716','Zimbabwe','Africa','Sub-Saharan Africa');

-- Update Risk Level
UPDATE countries SET risk_level = 'HIGH' WHERE iso2 IN ('VE','HT');
UPDATE countries SET risk_level = 'MEDIUM'
WHERE iso2 NOT IN ('VE','HT','DO','US');
UPDATE countries SET risk_level = 'LOW'
WHERE iso2 IN ('DO','US');

-- Insertar Monedas
INSERT INTO ccurrencies (code_numeric, code_alpha, name, decimals) VALUES
('214', 'DOP', 'Peso Dominicano', 2),
('840', 'USD', 'Dólar Estadounidense', 2),
('978', 'EUR', 'Euro', 2);

-- Insertar MCC
INSERT INTO cmcc (mcc, descripcion, riesgo_nivel, permitido) VALUES
('5411', 'Supermercados y tiendas de comestibles', 'BAJO', TRUE),
('6011', 'Cajeros automáticos (ATM)', 'MEDIO', TRUE),
('7011', 'Hoteles y moteles', 'MEDIO', TRUE),
('7995', 'Apuestas y casinos', 'ALTO', FALSE);

-- Insertar Clientes
INSERT INTO ccustomers (customer_ref_id, first_name, last_name, email, document_id) VALUES
('CL-123456', 'Juan', 'Pérez', 'juan.perez@email.com', '001-1234567-8'),
('CL-789012', 'Maria', 'Gomez', 'maria.gomez@email.com', '001-9876543-2');

-- Insertar Cuentas
INSERT INTO caccounts (account_number, account_type, currency_code, customer_id) VALUES
('100020003000', 'Ahorros', 'DOP', (SELECT id FROM ccustomers WHERE customer_ref_id = 'CL-123456')),
('400050006000', 'Corriente', 'USD', (SELECT id FROM ccustomers WHERE customer_ref_id = 'CL-123456')),
('700080009000', 'Ahorros', 'DOP', (SELECT id FROM ccustomers WHERE customer_ref_id = 'CL-789012'));

-- Insertar Tarjetas
INSERT INTO ccardx (pan, pan_last_4, pan_bin, expiry_date, card_type, brand, status, account_id) VALUES
('4000123456789012', '9012', '400012', '1228', 'Débito', 'Visa', 'active', (SELECT id FROM caccounts WHERE account_number = '400050006000')),
('5100123456780001', '0001', '510012', '0627', 'Crédito', 'Mastercard', 'active', (SELECT id FROM caccounts WHERE account_number = '700080009000'));

-- Insertar Comercios
INSERT INTO cmerchants (mid, nombre_comercial, pais, ciudad, mcc, riesgo_nivel, permitido) VALUES
(1234567, 'Mi Tienda, Santo Domingo', 'DO', 'Santo Domingo', '5411', 'BAJO', TRUE);
INSERT INTO cmerchants (mid, nombre_comercial, pais, ciudad, mcc, riesgo_nivel, permitido) VALUES
(9876543, 'Hotel Caracas', 'VE', 'Caracas', '7011', 'MEDIO', TRUE);
INSERT INTO cmerchants (mid, nombre_comercial, pais, ciudad, mcc, riesgo_nivel, permitido) VALUES
(333444, 'Colmado Don Jose', 'DO', 'Santo Domingo', '5411', 'BAJO', TRUE);
INSERT INTO cmerchants (mid, nombre_comercial, pais, ciudad, mcc, riesgo_nivel, permitido) VALUES
(01, 'Casino Las Vegas', 'US', 'Las Vegas', '7995', 'ALTO', FALSE);

-- Insertar Transacciones de prueba (similar a tu script original)

-- Transacción 1: Normal - BAJO RIESGO
INSERT INTO ctransactions (
    card_id, mti, i_0002_pan, i_0003_processing_code, i_0004_amount_transaction,
    i_0007_transmission_datetime, i_0011_stan, i_0012_time_local, i_0013_date_local,
    i_0022_pos_entry_mode, i_0024_function_code_nii, i_0025_pos_condition_code,
    i_0032_acquiring_inst_id, i_0041_card_acceptor_tid, i_0042_card_acceptor_mid,
    i_0043_card_acceptor_name_loc, i_0049_currency_code_tx,
    es_fraude, probabilidad_fraude, nivel_riesgo, factores_riesgo,
    mensaje_analisis, recomendacion_analisis, analisis_timestamp, monto_dop_calculado,
    historial_tx_24h, historial_tx_7d, monto_promedio_30d, merchant_permitido, mcc_permitido
) VALUES (
    (SELECT id FROM ccardx WHERE pan = '4000123456789012'),
    '0100', '4000123456789012', '000000', '000000015050',
    '1114130930', '123456', '130930', '1114',
    '051', '200', '00',
    '123456', 'TERM0001', 'MERCHANT1234567',
    'Mi Tienda, Santo Domingo, DO', '840',
    FALSE, 0.15, 'BAJO', '',
    'Transacción dentro de parámetros normales', 'Recomendación: Transacción aprobada automáticamente',
    CURRENT_TIMESTAMP - INTERVAL '1 day', 8877.75,
    2, 5, 7500.00, TRUE, TRUE
);

-- Transacción 2: Alto Riesgo - USD, noche, Venezuela, hotel
INSERT INTO ctransactions (
    card_id, mti, i_0002_pan, i_0003_processing_code, i_0004_amount_transaction,
    i_0007_transmission_datetime, i_0011_stan, i_0012_time_local, i_0013_date_local,
    i_0022_pos_entry_mode, i_0024_function_code_nii, i_0025_pos_condition_code,
    i_0032_acquiring_inst_id, i_0041_card_acceptor_tid, i_0042_card_acceptor_mid,
    i_0043_card_acceptor_name_loc, i_0049_currency_code_tx,
    es_fraude, probabilidad_fraude, nivel_riesgo, factores_riesgo,
    mensaje_analisis, recomendacion_analisis, analisis_timestamp, monto_dop_calculado,
    historial_tx_24h, historial_tx_7d, monto_promedio_30d, merchant_permitido, mcc_permitido
) VALUES (
    (SELECT id FROM ccardx WHERE pan = '4000123456789012'),
    '0100', '4000123456789012', '000000', '000000100000',
    '1114030510', '123457', '030510', '1114',
    '051', '200', '00',
    '987654', 'TERM0002', 'MERCHANT9876543',
    'Hotel Caracas, VE', '840',
    TRUE, 0.85, 'ALTO', 'MONTO_ELEVADO,HORARIO_NOCTURNO,PAIS_ALTO_RIESGO,TRANSACCION_DIVISA,DIVISA_MONTO_ELEVADO',
    'ALERTA: Transacción identificada como fraudulenta por modelo ML y reglas de negocio',
    'Recomendación: Revisar transacción manualmente y contactar al cliente',
    CURRENT_TIMESTAMP - INTERVAL '1 hour', 59000.00,
    1, 3, 20000.00, TRUE, TRUE
);

-- Transacción 3: Tarjeta desconocida - ALTO RIESGO
INSERT INTO ctransactions (
    card_id, mti, i_0002_pan, i_0003_processing_code, i_0004_amount_transaction,
    i_0007_transmission_datetime, i_0011_stan, i_0012_time_local, i_0013_date_local,
    i_0022_pos_entry_mode, i_0024_function_code_nii, i_0025_pos_condition_code,
    i_0032_acquiring_inst_id, i_0041_card_acceptor_tid, i_0042_card_acceptor_mid,
    i_0043_card_acceptor_name_loc, i_0049_currency_code_tx,
    es_fraude, probabilidad_fraude, nivel_riesgo, factores_riesgo,
    mensaje_analisis, recomendacion_analisis, analisis_timestamp, monto_dop_calculado,
    historial_tx_24h, historial_tx_7d, monto_promedio_30d, merchant_permitido, mcc_permitido
) VALUES (
    NULL,
    '0100', '9999000011112222', '000000', '00000000500000',
    '1114021530', '555444', '021530', '1114',
    '021', '200', '00',
    '111222', 'TERM0003', 'MERCHANT333444',
    'Colmado Don Jose, Santo Domingo, DO', '214',
    TRUE, 0.70, 'ALTO', 'MONTO_ELEVADO,HORARIO_NOCTURNO,MONTO_ALTO_HORARIO_SOSPECHOSO',
    'ALERTA: Múltiples factores de riesgo identificados',
    'Recomendación: Revisar transacción manualmente y contactar al cliente',
    CURRENT_TIMESTAMP - INTERVAL '30 minutes', 5000.00,
    4, 10, 4500.00, TRUE, TRUE
);

-- Factores 4: Factores de Riesgo

INSERT INTO risk_factors (code, description, weight, category, severity, enabled)
VALUES
-- MONTOS
('HIGH_AMOUNT', 'Monto alto para el perfil / umbral regulatorio', 2.0, 'AMOUNT', 'HIGH', TRUE),
('AMOUNT_TOO_LOW', 'Monto inusualmente bajo', 0.5, 'AMOUNT', 'LOW', TRUE),

-- MONEDAS
('FOREIGN_CURRENCY_TRNX', 'Transacción en moneda extranjera', 1.0, 'CURRENCY', 'MEDIUM', TRUE),
('HIGH_USD_TRNX', 'Transacción alta en USD', 1.5, 'CURRENCY', 'HIGH', TRUE),
('HIGH_EUR_TRNX', 'Transacción alta en EUR', 1.5, 'CURRENCY', 'HIGH', TRUE),

-- HORARIO
('NIGHT_TIME', 'Transacción en horario inusual (0–5 AM)', 1.0, 'TIME', 'MEDIUM', TRUE),

-- GEO / PAÍS
('HIGH_RISK_COUNTRY', 'País clasificado como alto riesgo', 3.0, 'GEO', 'HIGH', TRUE),
('MEDIUM_RISK_COUNTRY', 'País clasificado como riesgo medio', 1.5, 'GEO', 'MEDIUM', TRUE),
('LOW_RISK_COUNTRY', 'País no listado → riesgo bajo', 0.2, 'GEO', 'LOW', TRUE),
('COUNTRY_NOT_PROVIDED', 'País no provisto en la transacción', 1.0, 'GEO', 'MEDIUM', TRUE),

-- OFAC
('OFAC_PARTIAL_MATCH', 'Coincidencia parcial en OFAC', 0.2, 'OFAC', 'LOW', TRUE),

-- ML
('ANOMALY_DETECTED', 'Modelo de ML a detectado una anomalia', 2, 'ML', 'HIGH', TRUE),

-- FACTORES DERIVADOS / COMBINADOS
('HIGH_AMOUNT_SUSPICIOUS_TIME', 'Monto alto ejecutado en horario de bajo tráfico', 4.0, 'COMBO', 'HIGH', TRUE);

INSERT INTO risk_factor_critical (factor_code, auto_fail)
VALUES
('OFAC_FULL_MATCH', TRUE),
('STOLEN_DEVICE', TRUE),
('ID_MISMATCH', TRUE),
('KYC_FAILED', TRUE);

INSERT INTO risk_factor_rules (trigger_factors, result_factor, weight_override, enabled)
VALUES
(
    ARRAY['HIGH_AMOUNT', 'NIGHT_TIME'], 
    'HIGH_AMOUNT_SUSPICIOUS_TIME',
    4.0,
    TRUE
);

INSERT INTO risk_factor_rules (trigger_factors, result_factor, weight_override, enabled)
VALUES
(
    ARRAY['HIGH_RISK_COUNTRY', 'FOREIGN_CURRENCY_TRNX'],
    'CURRENCY_GEO_DANGER',
    3.5,
    TRUE
);

INSERT INTO risk_factors (code, description, weight, category, severity, enabled)
VALUES 
('CURRENCY_GEO_DANGER', 'Moneda extranjera desde país de alto riesgo', 3.5, 'COMBO', 'HIGH', TRUE);

INSERT INTO risk_factor_rules (trigger_factors, result_factor, weight_override, enabled)
VALUES
(
    ARRAY['MEDIUM_RISK_COUNTRY', 'HIGH_AMOUNT'],
    'MEDIUM_COUNTRY_HIGH_AMOUNT',
    2.5,
    TRUE
);

INSERT INTO risk_factors (code, description, weight, category, severity, enabled)
VALUES 
('MEDIUM_COUNTRY_HIGH_AMOUNT', 'País de riesgo medio con monto elevado', 2.5, 'COMBO', 'HIGH', TRUE);


-- Verificación rápida
SELECT 'ccurrencies' as tabla, COUNT(*) FROM ccurrencies
UNION ALL
SELECT 'ccustomers', COUNT(*) FROM ccustomers
UNION ALL
SELECT 'caccounts', COUNT(*) FROM caccounts
UNION ALL
SELECT 'ccardx', COUNT(*) FROM ccardx
UNION ALL
SELECT 'cmcc', COUNT(*) FROM cmcc
UNION ALL
SELECT 'cmerchants', COUNT(*) FROM cmerchants
UNION ALL
SELECT 'ctransactions', COUNT(*) FROM ctransactions;